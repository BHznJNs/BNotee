(function(){"use strict";var e={3059:function(e,t,o){var s=o(9963),i=o(6252),n=o(3577);function l(e,t,o,s,l,c){const d=(0,i.up)("tool-bar"),a=(0,i.up)("control-balls"),r=(0,i.up)("msgbar"),h=(0,i.up)("note"),u=(0,i.up)("fixed-components"),p=(0,i.up)("anchors");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",{class:(0,n.C_)(["dark-filter",{darken:l.isDarkMode}])},null,2),(0,i.Wm)(d,{isTouchMode:l.isTouchMode},null,8,["isTouchMode"]),(0,i.Wm)(a,{isDarkMode:l.isDarkMode,isTouchMode:l.isTouchMode,isFullscreen:l.isFullscreen,onToggleDarkMode:t[0]||(t[0]=e=>l.isDarkMode=!l.isDarkMode),onToggleTouchMode:t[1]||(t[1]=e=>l.isTouchMode=!l.isTouchMode),onToggleFullscreen:t[2]||(t[2]=e=>l.isFullscreen=!l.isFullscreen)},null,8,["isDarkMode","isTouchMode","isFullscreen"]),(0,i.Wm)(r),(0,i.Wm)(h,{isFullscreen:l.isFullscreen,isTouchMode:l.isTouchMode},null,8,["isFullscreen","isTouchMode"]),(0,i.Wm)(u),(0,i.Wm)(p)],64)}const c=e=>((0,i.dD)("data-v-45826c3a"),e=e(),(0,i.Cn)(),e),d={class:"toolbar shadow-3"},a={class:"logo shadow-2"},r=c((()=>(0,i._)("i",{class:"material-icons"},"info_outline",-1))),h=[r],u=c((()=>(0,i._)("i",{class:"material-icons"},"format_list_bulleted",-1))),p=[u],b={class:"tools"},m=c((()=>(0,i._)("i",{class:"material-icons"},"add",-1))),f=[m],v=c((()=>(0,i._)("i",{class:"material-icons"},"remove",-1))),T=[v],g=c((()=>(0,i._)("i",{class:"material-icons"},"indeterminate_check_box",-1))),C=[g],_=c((()=>(0,i._)("i",{class:"material-icons"},"color_lens",-1))),w=[_],k=c((()=>(0,i._)("i",{class:"material-icons"},"clear_all",-1))),N=[k],y=c((()=>(0,i._)("i",{class:"material-icons"},"vertical_align_bottom",-1))),x=[y],M={class:"material-icons file"},L={ref:"fileUploader",type:"file",accept:"application/json"};function j(e,t,o,l,c,r){const u=(0,i.up)("info");return(0,i.wg)(),(0,i.iD)("div",d,[(0,i.Wm)(u,{disabled:!c.isInfoWindowShow},null,8,["disabled"]),(0,i._)("div",a,[(0,i._)("div",{class:(0,n.C_)(["info-outer",{disabled:!c.isInfoIconShow}]),onClick:t[0]||(t[0]=e=>c.isInfoWindowShow=!0)},h,2),(0,i._)("div",{class:"logo-outer",onClick:t[1]||(t[1]=(...e)=>r.logoClick&&r.logoClick(...e))},p)]),(0,i._)("div",b,[(0,i._)("div",{class:(0,n.C_)(["tool btn btn-shallow",{disabled:!r.selectedNode.loc}]),onClick:t[2]||(t[2]=(...e)=>r.openTextfield&&r.openTextfield(...e))},f,2),(0,i._)("div",{class:(0,n.C_)(["tool btn btn-shallow",{disabled:!r.selectedNode.loc}]),onClick:t[3]||(t[3]=(...e)=>r.toDeleteNode&&r.toDeleteNode(...e))},T,2),(0,i.wy)((0,i._)("div",{class:(0,n.C_)(["tool btn btn-shallow",{disabled:!r.selectedNode.loc}]),onClick:t[4]||(t[4]=(...e)=>r.nodeCancelSelect&&r.nodeCancelSelect(...e))},C,2),[[s.F8,o.isTouchMode]]),(0,i._)("div",{class:(0,n.C_)(["tool btn btn-shallow",{disabled:!["h1","h2","h3","h4","p","li"].includes(r.selectedNode.type)}]),onClick:t[5]||(t[5]=(...e)=>r.openColors&&r.openColors(...e))},w,2),(0,i._)("div",{class:"tool btn btn-shallow",onClick:t[6]||(t[6]=(...e)=>r.clearNodes&&r.clearNodes(...e))},N),(0,i._)("div",{class:"tool btn btn-shallow",onClick:t[7]||(t[7]=(...e)=>r.saveNote&&r.saveNote(...e)),onContextmenu:t[8]||(t[8]=(0,s.iM)(((...e)=>r.saveMarkdown&&r.saveMarkdown(...e)),["prevent"]))},x,32),(0,i._)("div",{class:"tool btn btn-shallow",onClick:t[9]||(t[9]=(...e)=>r.readNote&&r.readNote(...e))},[(0,i._)("i",M,[(0,i.Uk)("input "),(0,i._)("input",L,null,512)])])])])}const D=e=>((0,i.dD)("data-v-3f43b375"),e=e(),(0,i.Cn)(),e),S={class:"info-outer"},O=D((()=>(0,i._)("i",{class:"material-icons"},"close",-1))),$=[O],F=D((()=>(0,i._)("div",{class:"info"},[(0,i._)("h1",null,"关于 | About"),(0,i._)("hr"),(0,i._)("h2",null,"此 | This"),(0,i._)("p",null," 一个运行在浏览器上的笔记程序。| A notebook application works on your Browser. "),(0,i._)("hr"),(0,i._)("h2",null,"作者 | Author"),(0,i._)("p",null,[(0,i.Uk)(" GitHub: "),(0,i._)("a",{href:"https://github.com/BHznJNs",target:"_blank"},"https://github.com/BHznJNs"),(0,i._)("br"),(0,i.Uk)(" BiliBili: "),(0,i._)("a",{href:"https://space.bilibili.com/274945998",target:"_blank"},"https://space.bilibili.com/274945998"),(0,i._)("br")]),(0,i._)("hr"),(0,i._)("h2",null,"框架 | Framework"),(0,i._)("p",null,[(0,i.Uk)(" Vue.js "),(0,i._)("a",{href:"https://v3.cn.vuejs.org/",target:"_blank"},"https://v3.cn.vuejs.org/"),(0,i._)("br"),(0,i.Uk)(" MDUI "),(0,i._)("a",{href:"https://www.mdui.org/",target:"_blank"},"https://www.mdui.org/")])],-1)));function I(e,t,o,s,n,l){const c=(0,i.up)("window");return(0,i.wg)(),(0,i.j4)(c,{width:"800px",height:"480px",disabled:o.disabled,onClose:l.close},{default:(0,i.w5)((()=>[(0,i._)("div",S,[(0,i._)("div",{class:"closer shadow-1",onClick:t[0]||(t[0]=(...e)=>l.close&&l.close(...e))},$),F])])),_:1},8,["disabled","onClose"])}const E={class:"window-outer"};function A(e,t,o,s,l,c){return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["window-container",{disabled:o.disabled}])},[(0,i._)("div",{class:"fullscreen-mask",onClick:t[0]||(t[0]=(...e)=>c.close&&c.close(...e))}),(0,i._)("div",E,[(0,i._)("div",{class:"window shadow-16",style:(0,n.j5)({width:o.width,height:o.height})},[(0,i.WI)(e.$slots,"default",{},void 0,!0)],4)])],2)}var H={props:["width","height","disabled"],methods:{close(){this.$emit("close")}}},W=o(3744);const B=(0,W.Z)(H,[["render",A],["__scopeId","data-v-6e558882"]]);var Z=B,U={components:{Window:Z},props:["disabled"],methods:{close(){this.$parent.isInfoWindowShow=!1}}};const K=(0,W.Z)(U,[["render",I],["__scopeId","data-v-3f43b375"]]);var V=K,R={inject:["note"],computed:{getThisObj(){if(!this.location)return;let e;return this.getNodeObj({location:this.location,callback:(t,o)=>{e=t[o]}}),e}},methods:{getNodeObj({parentObj:e=this.note,location:t,num:o=0,callback:s}){o==t.length-1?s&&s(e.CTS,t[o]):this.getNodeObj({parentObj:e.CTS[t[o]],location:t,num:o+1,callback:s})}}};const G=R;var Y=G,z={methods:{insertNode(e,t){e&&t&&this.getNodeObj({location:t,callback:(t,o)=>{t.splice(o+1,0,e)}})}}},q={methods:{deleteNode(e){let t;return this.selectedNode.vnode&&(this.selectedNode.loc=null,this.selectedNode.type="",this.selectedNode.vnode=null,this.selectedNode.obj=null),this.getNodeObj({location:e,callback:(e,o)=>{t=e[o],e.splice(o,1)}}),t}}},J=o(9473);function P(e,t){function o(e,t){const s="    ".repeat(t),i=e.OL,n=i?"1. ":"- ",l=e.CTS;let c="";for(const d of l)"li"==d.NT?c+=s+n+d.CT+"\n\n":c+=o(d,t+1);return c}const s=e.CT;let i,n=!1,l=!1;switch(e.NT){case"h":i="#".repeat(t)+s;break;case"hr":i="* * *";break;case"p":i="  ".repeat(t-1)+s;break;case"link":i=`[${s}](${e.HF})`;break;case"floor":n=!0,i=Q(e.CTS,t+1);break;case"list":n=!0,i=o(e,0),l=!0;break;case"table":i=(0,J.x)(e.CTS),l=!0;break;case"details":i=`> ${e.SUM}`;for(const t of e.CTS)i+="\n\n>> "+t.CT;l=!0;break;case"code":i=`\`\`\`${e.LG}\n${e.CT}\n\`\`\``;break;default:return console.log("Unknown node type!"),""}return n||(i+="\n\n"),l&&(i+="\n"),i}function Q(e,t){let o="";for(const s of e)o+=P(s,t);return o}var X=e=>{const t=e.CTS;return Q(t,1)},ee=o(9391),te=new ee.Z,oe=o(3162),se=o.n(oe),ie={data(){return{isInfoIconShow:!1,isInfoWindowShow:!1}},props:["isTouchMode"],inject:["note","selectedNode"],components:{Info:V},mixins:[Y,z,q],mounted(){const e=this.$refs.fileUploader;e.addEventListener("change",(()=>{let t=new FileReader;t.readAsText(e.files[0],"uft8"),t.onload=e=>{let t=e.target.result;this.note.CTS=JSON.parse(t),te.emit("note-loaded")}})),te.on("textfield-return-toolBar",(e=>{this.toInsertNode(e)}))},methods:{logoClick(){this.isInfoIconShow=!0,setTimeout((()=>{this.isInfoIconShow=!1}),3e3)},openTextfield(){te.emit("textfield-open","toolBar")},toInsertNode(e){const t=Array.from(this.selectedNode.loc);this.insertNode(e,t),t[t.length-1]+=1,te.emit("add-history",{loc:t,prop:"IST"})},toDeleteNode(){const e=this.selectedNode.loc,t=this.deleteNode(e);e[e.length-1]-=1,te.emit("add-history",{loc:e,prop:"DEL",nodeObj:t})},nodeCancelSelect(){this.selectedNode.vnode.selected=!1,this.selectedNode.loc=null,this.selectedNode.obj=null,this.selectedNode.type=null},openColors(){te.emit("fixedComponents-open","colors")},clearNodes(){this.note.CTS=[],this.note.HT=[],te.emit("clear-history")},saveNote(){let e=new Blob([JSON.stringify(this.note.CTS)],{type:"text/plain;charset=utf-8"});const t=this.note.NM||"MyNote";se()(e,t+".json")},saveMarkdown(){const e=X(this.note);let t=new Blob([e],{type:"text/plain;charset=utf-8"});const o=this.note.NM||"MyNote";se()(t,o+".md")},readNote(){const e=this.$refs.fileUploader;e.click()}}};const ne=(0,W.Z)(ie,[["render",j],["__scopeId","data-v-45826c3a"]]);var le=ne;const ce=e=>((0,i.dD)("data-v-dd01c8e2"),e=e(),(0,i.Cn)(),e),de=ce((()=>(0,i._)("i",{class:"material-icons"},"add",-1))),ae=[de];function re(e,t,o,l,c,d){const a=(0,i.up)("floor-block"),r=(0,i.up)("node-renderer"),h=(0,i.up)("textfield-group");return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["note-outer shadow-4",{fullscreen:o.isFullscreen}])},[(0,i._)("div",{class:"note",ref:"note",onContextmenu:t[1]||(t[1]=(0,s.iM)((()=>{}),["prevent"]))},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(d.note.CTS,((e,t)=>((0,i.wg)(),(0,i.iD)(i.HY,{key:e.id},["floor"==e.NT?((0,i.wg)(),(0,i.j4)(a,{key:0,children:e.CTS,level:2,location:[t]},null,8,["children","location"])):((0,i.wg)(),(0,i.j4)(r,{key:1,level:1,nodeObj:e,location:[t]},null,8,["nodeObj","location"]))],64)))),128)),(0,i.Wm)(h,{id:"note-textfield-group",ref:"textfield",isAdding:c.isNodeAdding,onReturnNode:d.closeNodeAdder},null,8,["isAdding","onReturnNode"]),(0,i._)("div",{class:(0,n.C_)(["btn-fab adder-btn",{disabled:c.isNodeAdding,fullscreen:o.isFullscreen}]),onClick:t[0]||(t[0]=(...e)=>d.openNodeAdder&&d.openNodeAdder(...e))},ae,2)],544)],2)}o(7658);const he=["#","`","_","/","-",":"],ue={"##":"strong","``":"code",__:"u","//":"i","--":"del","::":"span"};function pe(e){const t=[];let o="",s="";for(let i of e)he.includes(i)?i==s?(t.push({type:"text",content:o.slice(0,-1)}),t.push({type:"key",content:i.repeat(2)}),s="",o=""):(o+=i,s=i):(s.length&&(s=""),o+=i);return o.length&&t.push({type:"text",content:o}),t}function be(e){const t=[];let o="",s="",i="";for(let n of e){const e=n.content;if(o+=e,"key"==n.type)if("key"==s){if(e!=i)continue;const n=ue[e];t.push({tagName:n,content:o}),s="",o=""}else s="key",i=e;else"key"!=s&&(t.push({tagName:"text",content:o}),o="")}if(o.length){const e=t[t.length-1];e.content+=o}return t}function me(e,t){return`<${e}>${t}</${e}>`}function fe(e){const t=[];for(let o of e)"text"==o.tagName?t.push(o.content):t.push(me(o.tagName,o.content));return t}function ve(e){if(!e)return null;const t=pe(e),o=be(t);let s;s=fe(o);const i=s.join("");return i}async function Te(){const e=document.getElementsByClassName("inline-style");for(let t of e){const e=t.textContent;if(!e)continue;const o=ve(e,"HTML");t.innerHTML=o}}var ge={outputer:ve,init:Te};const Ce=(0,i._)("div",{class:"mask"},null,-1);function _e(e,t,o,s,l,c){const d=(0,i.up)("floor-block",!0),a=(0,i.up)("node-renderer"),r=(0,i.up)("block-controls");return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["floor shadow-1",{"shadow-3":l.selected,"touch-mode":c.isTouchMode}]),onMouseenter:t[0]||(t[0]=(...t)=>e.onMouseEnter&&e.onMouseEnter(...t)),onMouseleave:t[1]||(t[1]=(...t)=>e.onMouseLeave&&e.onMouseLeave(...t))},[Ce,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.children,((e,t)=>((0,i.wg)(),(0,i.iD)(i.HY,{key:e.id},["floor"==e.NT?((0,i.wg)(),(0,i.j4)(d,{key:0,children:e.CTS,level:o.level+1,location:o.location.concat([t])},null,8,["children","level","location"])):((0,i.wg)(),(0,i.j4)(a,{key:1,nodeObj:e,level:o.level,location:o.location.concat([t])},null,8,["nodeObj","level","location"]))],64)))),128)),(0,i.Wm)(r,{disabled:!e.hover,isTouchMode:c.isTouchMode,selected:l.selected,location:o.location,parentType:"floor"},null,8,["disabled","isTouchMode","selected","location"])],34)}var we={methods:{selectEvent(){this.selected?(te.emit("fixedComponents-close"),this.selectedNode.loc=null,this.selectedNode.vnode=null,this.selectedNode.obj=null,this.selectedNode.type=null,this.selected=!1):(this.selectedNode.loc&&(this.selectedNode.vnode.selected=!1),this.selectedNode.loc=this.location,this.selectedNode.vnode=this,this.selectedNode.obj=this.getThisObj,this.selectedNode.type=this.tagName,this.selected=!0)}}},ke={data(){return{selected:!1,initialContent:"",editing:!1,dbTouch:!1}},inject:["selectedNode"],mixins:[Y,we],props:["tagName","content","location","color"],watch:{content(e){this.$nextTick((()=>{const t=ge.outputer(e);this.$el.innerHTML=t}))}},render(){return(0,i.h)(this.tagName,{contentEditable:!0,class:{selected:this.selected,editing:this.editing,"inline-style":!0},style:{color:this.color},onContextmenu:e=>{e.preventDefault(),this.initialContent||(this.initialContent=e.target.innerText),this.selectEvent()},onTouchstart:()=>{this.dbTouch&&this.selectEvent(),this.dbTouch=!0,setTimeout((()=>{this.dbTouch=!1}),300)},onClick:()=>{this.editing||(this.initialContent=this.$el.innerText),this.editing=!0},onBlur:e=>{const t=e.target.innerText;t!=this.initialContent&&(this.getThisObj.CT=t,te.emit("add-history",{loc:this.location,prop:"CT",before:this.initialContent,after:t}),this.initialContent=t),this.editing=!1}},this.content)}};const Ne=ke;var ye=Ne,xe={props:["level","content","location","color"],components:[ye],mounted(){this.$nextTick((()=>{te.emit("anchor-mounted")}))},render(){let e;return e=this.level<6?"h"+this.level:"h5",(0,i.h)(ye,{tagName:e,id:this.location.join(""),class:"heading",content:this.content,color:this.color,location:this.location})}};const Me=xe;var Le=Me,je={data(){return{selected:!1,initialContent:"",editing:!1,dbRightClick:!1}},inject:["selectedNode"],mixins:[Y,we],props:["tagName","content","location","color","href"],render(){return(0,i.h)(this.tagName,{contentEditable:!0,href:this.href,target:"_blank",class:{selected:this.selected,editing:this.editing,"inline-style":!0},style:{color:this.color},onClick:e=>{e.preventDefault(),window.open(this.href),this.$el.blur()},onContextmenu:e=>{e.preventDefault(),this.dbRightClick?this.selectEvent():(this.dbRightClick=!0,setTimeout((()=>{this.dbRightClick=!1}),300),this.editing||(this.initialContent=e.target.innerText),this.editing=!0)},onBlur:e=>{const t=e.target.innerText;t!=this.initialContent&&(this.getThisObj.CT=t,te.emit("add-history",{loc:this.location,prop:"CT",before:this.initialContent,after:t}),this.initialContent=t),this.editing=!1}},this.content)}};const De=je;var Se=De;const Oe=(0,i._)("div",{class:"mask"},null,-1),$e=(0,i._)("i",{class:"material-icons"},"playlist_add",-1),Fe=[$e],Ie={class:"material-icons"},Ee={class:"material-icons"};function Ae(e,t,o,l,c,d){const a=(0,i.up)("list-block",!0),r=(0,i.up)("basic-node"),h=(0,i.up)("list-child"),u=(0,i.up)("block-controls");return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["list",{"shadow-2":c.selected,hover:e.hover,empty:!o.children.length,"touch-mode":d.isTouchMode,nested:c.isNested}]),onMouseenter:t[2]||(t[2]=(...t)=>e.onMouseEnter&&e.onMouseEnter(...t)),onMouseleave:t[3]||(t[3]=(...t)=>e.onMouseLeave&&e.onMouseLeave(...t))},[Oe,(0,i.Wm)(h,{ordered:o.isOrdered},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.children,((t,s)=>((0,i.wg)(),(0,i.iD)(i.HY,{key:t.id},["list"==t.NT?((0,i.wg)(),(0,i.j4)(a,{key:0,isOrdered:t.OL,children:t.CTS,location:o.location.concat([s]),onMouseInChild:e.onMouseLeave},null,8,["isOrdered","children","location","onMouseInChild"])):((0,i.wg)(),(0,i.j4)(r,{key:1,tagName:"li",content:t.CT,color:t.CL,location:o.location.concat([s])},null,8,["content","color","location"]))],64)))),128))])),_:1},8,["ordered"]),(0,i.Wm)(u,{disabled:!e.hover,isTouchMode:d.isTouchMode,selected:c.selected,location:o.location,parentType:"list"},{default:(0,i.w5)((()=>[(0,i._)("div",{class:"btn btn-normal tool-btn-in-block",onClick:t[0]||(t[0]=(...e)=>d.addListBlock&&d.addListBlock(...e))},Fe),(0,i._)("div",{class:"btn btn-normal tool-btn-in-block",onClick:t[1]||(t[1]=(...e)=>d.toggleOrdered&&d.toggleOrdered(...e))},[(0,i.wy)((0,i._)("i",Ie,"format_list_bulleted",512),[[s.F8,o.isOrdered]]),(0,i.wy)((0,i._)("i",Ee,"format_list_numbered",512),[[s.F8,!o.isOrdered]])])])),_:1},8,["disabled","isTouchMode","selected","location"])],34)}const He=e=>((0,i.dD)("data-v-04fa293f"),e=e(),(0,i.Cn)(),e),We=He((()=>(0,i._)("i",{class:"material-icons"},"add",-1))),Be=[We],Ze={class:"checkbox"},Ue=["checked"];function Ke(e,t,o,s,l,c){return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["controls",{disabled:o.disabled&&!o.isTouchMode,"touch-mode":o.isTouchMode}])},[(0,i._)("div",{class:"btn btn-normal tool-btn-in-block",onClick:t[0]||(t[0]=(...t)=>e.addNode&&e.addNode(...t))},Be),(0,i.WI)(e.$slots,"default",{},void 0,!0),(0,i._)("label",Ze,[(0,i._)("input",{type:"checkbox",ref:"checkbox",checked:o.selected,onChange:t[1]||(t[1]=(...e)=>c.selectEvent&&c.selectEvent(...e))},null,40,Ue),(0,i._)("i",{class:"checkbox-icon",onTouchstart:t[2]||(t[2]=(...e)=>c._touchstart&&c._touchstart(...e)),onTouchend:t[3]||(t[3]=(...e)=>c._touchend&&c._touchend(...e))},null,32)])],2)}var Ve={methods:{tableAdder(e){const t=e.length,o=e[0].length;let s=[];for(let i=0;i<o;i++)s.push("");e.push(s),te.emit("add-history",{loc:this.location,prop:"ROW",before:t,after:t+1})},detailAdder(e){e.push({CT:"",CL:"#333"});const t=Object.create(this.location);t.push(e.length-1),te.emit("add-history",{loc:t,prop:"IST"})},listAdder(e){e.push({NT:"li",CT:"",CL:"#333"});const t=Object.create(this.location);t.push(e.length-1),te.emit("add-history",{loc:t,prop:"IST"})},floorAdder(e){te.off("textfield-return-"+this.parentType),te.on("textfield-return-"+this.parentType,(t=>{t&&e.push(t);const o=Array.from(this.location);o.push(e.length-1),te.emit("add-history",{loc:o,prop:"IST"}),te.off("textfield-return-"+this.parentType)})),te.emit("textfield-open",this.parentType)},addNode(){const e=this.getThisObj.CTS;switch(this.parentType){case"table":this.tableAdder(e);break;case"details":this.detailAdder(e);break;case"list":this.listAdder(e);break;case"floor":this.floorAdder(e)}}}},Re={data(){return{timeout:null}},props:["isTouchMode","parentType","disabled","location","selected"],inject:["selectedNode"],mixins:[Y,Ve],methods:{_touchstart(){this.timeout=setTimeout((()=>{this.addNode()}),1e3)},_touchend(){clearTimeout(this.timeout)},selectEvent(){const e=this.$refs.checkbox.checked;this.$parent.selected=e,e?(this.selectedNode.loc&&(this.selectedNode.vnode.selected=!1),this.selectedNode.loc=this.location,this.selectedNode.vnode=this.$parent,this.selectedNode.type=this.parentType,"list"==this.parentType&&(this.selectedNode.type=this.$parent.isNested?"nestedList":"notNestedList")):(this.selectedNode.loc=null,this.selectedNode.vnode=null,this.selectedNode.type=null)}}};const Ge=(0,W.Z)(Re,[["render",Ke],["__scopeId","data-v-04fa293f"]]);var Ye=Ge,ze={data(){return{hover:!1,setTimeout:null}},methods:{onMouseEnter(){this.setTimeout=setTimeout((()=>{this.hover=!0}),400)},onMouseLeave(){clearTimeout(this.setTimeout),this.selected||(this.hover=!1)}}},qe={name:"list-block",data(){return{selected:!1,isNested:null}},components:{BasicNode:ye,BlockControls:Ye,listChild:{props:["ordered"],render(){return(0,i.h)(this.ordered?"ol":"ul",this.$slots.default())}}},props:["children","isOrdered","location"],inject:["isTouchMode"],mixins:[Y,ze],methods:{addListBlock(){const e=this.getThisObj.CTS;e.push({NT:"list",OL:!1,CTS:[{NT:"li",CT:"",CL:"#333"}]});const t=Object.create(this.location);t.push(e.length-1),te.emit("add-history",{loc:t,prop:"IST"})},toggleOrdered(){this.getThisObj.OL=!this.getThisObj.OL}},mounted(){const e=this.$el.parentNode;this.isNested="OL"==e.tagName||"UL"==e.tagName}};const Je=(0,W.Z)(qe,[["render",Ae]]);var Pe=Je;const Qe=(0,i._)("div",{class:"mask"},null,-1),Xe=(0,i._)("i",{class:"material-icons"},"grid_on",-1),et=[Xe];function tt(e,t,o,s,l,c){const d=(0,i.up)("table-row"),a=(0,i.up)("block-controls");return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["table shadow-1",{"shadow-3":l.selected,"touch-mode":c.isTouchMode,hover:e.hover&&!c.isTouchMode}]),onMouseenter:t[1]||(t[1]=(...t)=>e.onMouseEnter&&e.onMouseEnter(...t)),onMouseleave:t[2]||(t[2]=(...t)=>e.onMouseLeave&&e.onMouseLeave(...t))},[Qe,(0,i._)("table",null,[(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.children,((e,t)=>((0,i.wg)(),(0,i.j4)(d,{key:e.id,children:e,location:o.location.concat(t)},null,8,["children","location"])))),128))])]),(0,i.Wm)(a,{isTouchMode:c.isTouchMode,disabled:!e.hover,selected:l.selected,location:o.location,parentType:"table"},{default:(0,i.w5)((()=>[(0,i._)("div",{class:"btn btn-normal tool-btn-in-block",onClick:t[0]||(t[0]=(...e)=>c.openTableSetter&&c.openTableSetter(...e))},et)])),_:1},8,["isTouchMode","disabled","selected","location"])],34)}const ot=["onBlur"];function st(e,t,o,s,l,c){return(0,i.wg)(),(0,i.iD)("tr",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.children,((e,o)=>((0,i.wg)(),(0,i.iD)("td",{key:e.id,onClick:t[0]||(t[0]=(...e)=>c.edit&&c.edit(...e)),onContextmenu:t[1]||(t[1]=(...e)=>c.edit&&c.edit(...e)),onBlur:e=>c.finishEdit(e,o),contenteditable:"true"},(0,n.zw)(e),41,ot)))),128))])}var it={mixins:[Y],props:["children","location"],methods:{edit(e){let t=e.target;t.classList.add("editing")},finishEdit(e,t){let o=e.target;o.classList.remove("editing");let s=o.innerText;this.getThisObj[t]=s}}};const nt=(0,W.Z)(it,[["render",st]]);var lt=nt,ct={data(){return{selected:!1}},props:["children","location"],inject:["isTouchMode"],mixins:[ze],components:{TableRow:lt,BlockControls:Ye},methods:{openTableSetter(){te.emit("fixedComponents-open","tableSetter"),te.emit("table-location",this.location)}}};const dt=(0,W.Z)(ct,[["render",tt]]);var at=dt;function rt(e,t,o,s,l,c){const d=(0,i.up)("basic-node"),a=(0,i.up)("block-controls");return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["details",{"shadow-2":l.selected,hover:e.hover,"touch-mode":c.isTouchMode}]),onMouseenter:t[2]||(t[2]=(...t)=>e.onMouseEnter&&e.onMouseEnter(...t)),onMouseleave:t[3]||(t[3]=(...t)=>e.onMouseLeave&&e.onMouseLeave(...t))},[(0,i._)("summary",{class:"summary",contenteditable:"true",ref:"summary",onBlur:t[0]||(t[0]=(...e)=>c.finishEdit&&c.finishEdit(...e))},(0,n.zw)(o.summary),545),(0,i._)("details",null,[(0,i._)("summary",{onContextmenu:t[1]||(t[1]=t=>e.$refs.summary.focus()),style:{"line-height":"1.4"}},null,32),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.children,((e,t)=>((0,i.wg)(),(0,i.j4)(d,{key:e.id,tagName:"p",content:e.CT,color:e.CL,location:o.location.concat([t])},null,8,["content","color","location"])))),128))]),(0,i.Wm)(a,{disabled:!e.hover,isTouchMode:c.isTouchMode,selected:l.selected,location:o.location,parentType:"details"},null,8,["disabled","isTouchMode","selected","location"])],34)}var ht={data(){return{selected:!1}},components:{BasicNode:ye,BlockControls:Ye},mixins:[Y,ze],inject:["isTouchMode"],props:["children","summary","location"],methods:{finishEdit(e){const t=e.target,o=t.innerText;te.emit("add-history",{loc:this.location,prop:"SUM",before:this.getThisObj.SUM,after:o}),this.getThisObj.SUM=o}}};const ut=(0,W.Z)(ht,[["render",rt],["__scopeId","data-v-7df230aa"]]);var pt=ut;function bt(e,t,o,s,n,l){const c=(0,i.up)("highlightjs");return t[0]||((0,i.qZ)(-1),t[0]=(0,i.Wm)(c,{code:o.code,language:o.language,autodetect:!1,onFocusout:l.render,onContextmenu:l.select,tabindex:"0"},null,8,["code","language","onFocusout","onContextmenu"]),(0,i.qZ)(1),t[0])}var mt=o(8783),ft=o(1073);function vt(e,t="end"){const o=window.getSelection(),s=o.getRangeAt(0),i=document.createTextNode(e);s.insertNode(i),"start"==t?o.collapseToStart():"end"==t?o.collapseToEnd():console.warn("Unknown direction type!")}function Tt(e){e.preventDefault(),vt("    ")}const gt=new Map([[")","("],["]","["],["}","{"],[">","<"]]),Ct=["html","xml","xhtml","svg","rss"];function _t(e,t){setTimeout((()=>{t?(vt(`${gt.get(e)}\n    `),vt(`\n${e}`,"start")):vt(e,"start")}),150)}var wt={methods:{codeInput(e){switch(e.keyCode){case 9:Tt(e);break;case 57:e.shiftKey&&_t(")",e.altKey);break;case 219:e.shiftKey?_t("}",e.altKey):_t("]",e.altKey);break;case 188:Ct.includes(this.language)&&_t(">");break;case 222:e.shiftKey?_t('"'):_t("'");break;case 192:_t("`",e.altKey);break}}}},kt={data(){return{tagName:"code",codeNode:null,selected:!1}},components:{highlightjs:ft.Z.component},mixins:[Y,we,wt],inject:["selectedNode"],props:["language","code","location"],watch:{code(e){this.codeNode.innerHTML=e,mt.Z.highlightElement(this.codeNode)}},methods:{render(){let e=this.codeNode.innerText;e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;");const t=this.getThisObj.CT,o=e;o!=t&&(te.emit("add-history",{loc:this.location,prop:"CT",before:this.getThisObj.CT,after:e}),this.getThisObj.CT=e)},select(){this.selectEvent(),this.codeNode.classList.toggle("selected",this.selected)}},mounted(){this.codeNode=this.$el.querySelector("code"),this.codeNode.contentEditable=!0,this.codeNode.addEventListener("keydown",this.codeInput),this.$nextTick((()=>{this.codeNode.innerHTML=this.code,mt.Z.highlightElement(this.codeNode)}))}};const Nt=(0,W.Z)(kt,[["render",bt]]);var yt=Nt,xt={props:["nodeObj","level","location"],render(){let e,t={location:this.location};switch(this.nodeObj.NT){case"h":e=Le,t.level=this.level,t.content=this.nodeObj.CT,t.color=this.nodeObj.CL;break;case"link":e=Se,t.tagName="a",t.content=this.nodeObj.CT,t.color=this.nodeObj.CL,t.href=this.nodeObj.HF;break;case"list":e=Pe,t.isOrdered=this.nodeObj.OL,t.children=this.nodeObj.CTS;break;case"table":e=at,t.children=this.nodeObj.CTS;break;case"details":e=pt,t.summary=this.nodeObj.SUM,t.children=this.nodeObj.CTS;break;case"code":e=yt,t.language=this.nodeObj.LG,t.code=this.nodeObj.CT;break;default:e=ye,t.tagName=this.nodeObj.NT,t.content=this.nodeObj.CT,t.color=this.nodeObj.CL}return(0,i.h)(e,t)}};const Mt=xt;var Lt=Mt,jt={name:"floor-block",components:{BlockControls:Ye,NodeRenderer:Lt},data(){return{selected:!1}},props:["level","location","children"],inject:["isTouchMode"],mixins:[ze]};const Dt=(0,W.Z)(jt,[["render",_e]]);var St=Dt;const Ot={class:"selector",ref:"selector"},$t=(0,i.uE)('<option value="h">标题</option><option value="p">段落</option><option value="link">链接</option><option value="hr">割线</option><option value="floor">层次</option><option value="ol">序列</option><option value="ul">乱列</option><option value="code">代码</option><option value="table">表格</option><option value="details">详情</option>',10),Ft=[$t],It=(0,i._)("i",{class:"material-icons"},"close",-1),Et=[It];function At(e,t,o,l,c,d){return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["textfield-group shadow-2",{disabled:!o.isAdding}])},[(0,i._)("select",Ot,Ft,512),(0,i._)("div",{class:"textfield",contenteditable:"true",ref:"inputter",onKeydown:t[0]||(t[0]=(0,s.D2)((0,s.iM)(((...e)=>d.enter&&d.enter(...e)),["prevent"]),["enter"]))},null,544),(0,i._)("div",{class:"textfield-closer closer",onClick:t[1]||(t[1]=e=>d.closeNodeAdder())},Et)],2)}var Ht=(e,t)=>{if(!t)return null;let o={NT:e};switch(e){case"h":case"p":case"li":o.CT=t,o.CL="#333";break;case"link":o.HF=t,o.CT="",o.CL="#333";break;case"hr":break;case"floor":o.CTS=[{NT:"h",CT:t,CL:"#333"}];break;case"ol":o.NT="list",o.CTS=[{NT:"li",CT:t,CL:"#333"}],o.OL=!0;break;case"ul":o.NT="list",o.CTS=[{NT:"li",CT:t,CL:"#333"}],o.OL=!1;break;case"code":o.LG=t,o.CT="";break;case"table":o.CTS=[[t,"","",""],["","","",""]];break;case"details":o.SUM=t,o.CTS=[{CT:"",CL:"#333"}];break}return o},Wt={props:["isAdding"],inject:["note"],methods:{focus(){const e=this.$refs.inputter;e.focus()},enter(){this.closeNodeAdder()},closeNodeAdder(){const e=this.$refs.selector,t=this.$refs.inputter,o=e.value,s=t.innerText,i=Ht(o,s);this.$emit("return-node",i),t.blur(),t.innerText=""}}};const Bt=(0,W.Z)(Wt,[["render",At]]);var Zt=Bt,Ut={components:{FloorBlock:St,NodeRenderer:Lt,TextfieldGroup:Zt},data(){return{isNodeAdding:!1}},props:["isFullscreen"],inject:["note"],created(){addEventListener("keydown",(e=>{const t=e.altKey,o=e.key;t&&"a"==o&&(e.preventDefault(),this.openNodeAdder())}))},mounted(){this.$nextTick((()=>{ge.init()})),te.on("note-loaded",(()=>{this.$nextTick((()=>{ge.init()}))}))},methods:{openNodeAdder(){location.href="#note-textfield-group",this.isNodeAdding=!0,this.$nextTick((()=>{this.$refs.textfield.focus()}))},closeNodeAdder(e){this.isNodeAdding=!1;const t=this.note.CTS;if(e){t.push(e);const o=[t.length-1];te.emit("add-history",{loc:o,prop:"IST"})}}},watch:{isFullscreen(e,t){e!=t&&(this.$refs.note.style.display="none",setTimeout((()=>{this.$refs.note.style.display="block"}),1200))}}};const Kt=(0,W.Z)(Ut,[["render",re],["__scopeId","data-v-dd01c8e2"]]);var Vt=Kt;function Rt(e,t,o,s,n,l){const c=(0,i.up)("anchors-view"),d=(0,i.up)("drawer");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(d,{title:"笔记摘要",disabled:n.drawerDisabled,onCloseDrawer:t[0]||(t[0]=e=>n.drawerDisabled=!0)},{default:(0,i.w5)((()=>[(0,i.Wm)(c,{list:n.anchorList},null,8,["list"])])),_:1},8,["disabled"])])}const Gt={class:"titlebar shadow-4"},Yt={class:"closer circle"},zt={class:"drawer-view"};function qt(e,t,o,s,l,c){return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",{class:(0,n.C_)(["fullscreen-mask",{disabled:o.disabled}]),onClick:t[0]||(t[0]=(...e)=>c.close&&c.close(...e))},null,2),(0,i._)("div",{class:(0,n.C_)(["drawer",{disabled:o.disabled}])},[(0,i._)("div",Gt,[(0,i._)("div",Yt,[(0,i._)("i",{class:"material-icons arrow-forward",onClick:t[1]||(t[1]=(...e)=>c.close&&c.close(...e))},"arrow_forward"),(0,i._)("i",{class:"material-icons arrow-upward",onClick:t[2]||(t[2]=(...e)=>c.close&&c.close(...e))},"arrow_upward")]),(0,i._)("h1",null,(0,n.zw)(o.title),1)]),(0,i._)("div",zt,[(0,i.WI)(e.$slots,"default")])],2)],64)}var Jt={props:["title","disabled"],emits:["close-drawer"],methods:{close(){this.$emit("close-drawer")}}};const Pt=(0,W.Z)(Jt,[["render",qt]]);var Qt=Pt,Xt={data(){return{drawerDisabled:!0,anchorList:[],timeout:null}},components:{Drawer:Qt,AnchorsView:{props:["list"],render(){let e=this.list.map((e=>(0,i.h)("a",{level:e.level,href:"#"+e.href},e.content)));return(0,i.h)("div",e)}}},inject:["note"],methods:{getAnchors(){const e=document.querySelectorAll(".heading");let t=[];for(let o of e)t.push({level:o.tagName,href:o.id,content:o.innerText});return t},close(){this.drawerDisabled=!0}},mounted(){te.on("open-anchors",(()=>{this.drawerDisabled=!1})),te.on("anchor-mounted",(()=>{this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.timeout=setTimeout((()=>{this.anchorList=this.getAnchors()}))}))}};const eo=(0,W.Z)(Xt,[["render",Rt]]);var to=eo;const oo=e=>((0,i.dD)("data-v-c8fd90ac"),e=e(),(0,i.Cn)(),e),so=oo((()=>(0,i._)("div",{class:"block"},[(0,i._)("div",{class:"mask"}),(0,i._)("i",{class:"material-icons"},"apps")],-1))),io=oo((()=>(0,i._)("i",{class:"material-icons"},"subtitles",-1))),no=[io],lo={class:"material-icons"},co={class:"material-icons"},ao=oo((()=>(0,i._)("i",{class:"material-icons"},"touch_app",-1))),ro=[ao],ho={class:"material-icons"},uo={class:"material-icons"};function po(e,t,o,l,c,d){return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["controlballs",{fullscreen:o.isFullscreen}])},[so,(0,i._)("div",{class:"ball btn",onClick:t[0]||(t[0]=(...e)=>d.openAnchors&&d.openAnchors(...e))},no),(0,i._)("div",{class:"ball btn",onClick:t[1]||(t[1]=t=>e.$emit("toggle-darkMode"))},[(0,i.wy)((0,i._)("i",lo,"brightness_2",512),[[s.F8,!o.isDarkMode]]),(0,i.wy)((0,i._)("i",co,"wb_sunny",512),[[s.F8,o.isDarkMode]])]),(0,i._)("div",{class:(0,n.C_)(["ball btn",{black:o.isTouchMode}]),onClick:t[2]||(t[2]=t=>e.$emit("toggle-touchMode"))},ro,2),(0,i._)("div",{class:"ball btn",onClick:t[3]||(t[3]=t=>e.$emit("toggle-fullscreen"))},[(0,i.wy)((0,i._)("i",ho,"fullscreen",512),[[s.F8,!o.isFullscreen]]),(0,i.wy)((0,i._)("i",uo,"fullscreen_exit",512),[[s.F8,o.isFullscreen]])])],2)}var bo={props:["isDarkMode","isTouchMode","isFullscreen"],emits:["toggle-darkMode","toggle-touchMode","toggle-fullscreen"],methods:{openAnchors(){te.emit("open-anchors")}}};const mo=(0,W.Z)(bo,[["render",po],["__scopeId","data-v-c8fd90ac"]]);var fo=mo;function vo(e,t,o,s,n,l){const c=(0,i.up)("textfield-group-fixed"),d=(0,i.up)("colors"),a=(0,i.up)("table-setter"),r=(0,i.up)("history");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(c,{onClose:l.close,disabled:n.textfieldGroupDisabled},null,8,["onClose","disabled"]),(0,i.Wm)(d,{onClose:l.close,disabled:n.colorsDisabled},null,8,["onClose","disabled"]),(0,i.Wm)(a,{onClose:l.close,disabled:n.tableSetterDisabled},null,8,["onClose","disabled"]),(0,i.Wm)(r,{disabled:n.historyDisabled},null,8,["disabled"])])}const To={class:"textfield-group fixed-component fixed"},go={class:"selector",ref:"selector"},Co=(0,i._)("option",{value:"h"},"标题",-1),_o=(0,i._)("option",{value:"p"},"段落",-1),wo=(0,i._)("option",{value:"link"},"链接",-1),ko=(0,i._)("option",{value:"hr"},"割线",-1),No=(0,i._)("option",{value:"floor"},"层次",-1),yo=(0,i._)("option",{value:"ol"},"序列",-1),xo=(0,i._)("option",{value:"ul"},"乱列",-1),Mo=(0,i._)("option",{value:"code"},"代码",-1),Lo=(0,i._)("option",{value:"table"},"表格",-1),jo=(0,i._)("option",{value:"details"},"详情",-1),Do=[Co,_o,wo,ko,No,yo,xo,Mo,Lo,jo],So={class:"selector",ref:"selector4List"},Oo=(0,i._)("option",{value:"li"},"列项",-1),$o=(0,i._)("option",{value:"ol"},"序列",-1),Fo=(0,i._)("option",{value:"ul"},"乱列",-1),Io=[Oo,$o,Fo],Eo=(0,i._)("i",{class:"material-icons"},"close",-1),Ao=[Eo];function Ho(e,t,o,n,l,c){return(0,i.wg)(),(0,i.j4)(s.uT,{name:"slide"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",To,[(0,i.wy)((0,i._)("select",go,Do,512),[[s.F8,!c.isFromNestedList]]),(0,i.wy)((0,i._)("select",So,Io,512),[[s.F8,c.isFromNestedList]]),(0,i._)("div",{class:"textfield",ref:"inputer",contenteditable:"true",onKeydown:t[0]||(t[0]=(0,s.D2)(((...e)=>c.onEnter&&c.onEnter(...e)),["enter"]))},null,544),(0,i._)("div",{class:"textfield-closer closer",onClick:t[1]||(t[1]=(...e)=>c.closeTextfield&&c.closeTextfield(...e))},Ao)],512),[[s.F8,!o.disabled]])])),_:1})}var Wo={data(){return{commandFrom:""}},props:["disabled"],inject:["selectedNode"],computed:{isFromNestedList(){return"list"==this.commandFrom||["li","nestedList"].includes(this.selectedNode.type)}},mounted(){te.on("textfield-open",(e=>{this.commandFrom=e}))},methods:{onEnter(e){e.altKey&&(e.preventDefault(),this.closeTextfield())},closeTextfield(){this.$emit("close","textfieldGroup");const e=this.isFromNestedList?this.$refs.selector4List.value:this.$refs.selector.value,t=this.$refs.inputer.innerText,o=Ht(e,t);te.emit("textfield-return-"+this.commandFrom,o),this.$refs.inputer.blur(),this.$refs.inputer.innerText=""}}};const Bo=(0,W.Z)(Wo,[["render",Ho]]);var Zo=Bo;const Uo=e=>((0,i.dD)("data-v-0a22116a"),e=e(),(0,i.Cn)(),e),Ko={class:"colors fixed-component"},Vo=["onClick"],Ro={class:"input-group"},Go=Uo((()=>(0,i._)("i",{class:"material-icons"},"close",-1))),Yo=[Go];function zo(e,t,o,l,c,d){return(0,i.wg)(),(0,i.j4)(s.uT,{name:"slide"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",Ko,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(c.colors,(e=>((0,i.wg)(),(0,i.iD)("div",{key:e.id,class:"color btn btn-shallow",style:(0,n.j5)({"background-color":e}),onClick:t=>d.setColor(e)},null,12,Vo)))),128)),(0,i._)("div",Ro,[(0,i._)("div",{class:"hint",onClick:t[0]||(t[0]=t=>e.$refs.colorInputter.click())},"#"),(0,i.wy)((0,i._)("input",{type:"color",ref:"colorInputter","onUpdate:modelValue":t[1]||(t[1]=e=>c.colorValue=e)},null,512),[[s.F8,!1],[s.nr,c.colorValue]]),(0,i.wy)((0,i._)("input",{class:"inputter",placeholder:"******",type:"text",maxlength:"8","onUpdate:modelValue":t[2]||(t[2]=e=>c.colorValue=e)},null,512),[[s.nr,c.colorValue]])]),(0,i._)("div",{class:"closer",onClick:t[3]||(t[3]=t=>e.$emit("close","colors"))},Yo)],512),[[s.F8,!o.disabled]])])),_:1})}var qo={data(){return{colors:["#D50000","#FFD600","#333"],colorValue:"",timeout:null}},props:["disabled"],inject:["selectedNode"],mixins:[Y],methods:{getColor(){const e=this.selectedNode.obj,t=e.CL;this.colorValue=t},setColor(e){const t=this.selectedNode.loc,o=this.selectedNode.obj,s=o.CL;o.CL=e,te.emit("add-history",{loc:t,prop:"CL",before:s,after:e})}},watch:{colorValue(e){clearTimeout(this.timeout),this.colorValue=e.replace("#",""),this.timeout=setTimeout((()=>{this.setColor("#"+this.colorValue)}),300)},disabled(e){e||this.getColor()}}};const Jo=(0,W.Z)(qo,[["render",zo],["__scopeId","data-v-0a22116a"]]);var Po=Jo;const Qo=e=>((0,i.dD)("data-v-75915245"),e=e(),(0,i.Cn)(),e),Xo={class:"table-setter fixed-component"},es={class:"input-group"},ts=Qo((()=>(0,i._)("i",{class:"hint material-icons"},"view_headline",-1))),os={class:"input-group"},ss=Qo((()=>(0,i._)("i",{class:"hint material-icons"},"view_column",-1))),is=Qo((()=>(0,i._)("i",{class:"material-icons"},"check",-1))),ns=[is],ls=Qo((()=>(0,i._)("i",{class:"material-icons"},"close",-1))),cs=[ls];function ds(e,t,o,n,l,c){return(0,i.wg)(),(0,i.j4)(s.uT,{name:"slide"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",Xo,[(0,i._)("div",es,[ts,(0,i.wy)((0,i._)("input",{class:"inputter",type:"text",placeholder:" > 0 ","onUpdate:modelValue":t[0]||(t[0]=e=>l.row=e)},null,512),[[s.nr,l.row]])]),(0,i._)("div",os,[ss,(0,i.wy)((0,i._)("input",{class:"inputter",type:"text",placeholder:" > 0 ",maxlength:"3","onUpdate:modelValue":t[1]||(t[1]=e=>l.col=e)},null,512),[[s.nr,l.col]])]),(0,i._)("div",{class:"closer",onClick:t[2]||(t[2]=(...e)=>c.tableSet&&c.tableSet(...e))},ns),(0,i._)("div",{class:"closer",onClick:t[3]||(t[3]=t=>e.$emit("close","tableSetter"))},cs)],512),[[s.F8,!o.disabled]])])),_:1})}var as={data(){return{row:1,col:1,targetNode:null,targetNodeLoc:[],timeout:null}},props:["disabled"],mixins:[Y],mounted(){const e={ROW:"row",COL:"col"};te.on("table-location",(e=>{this.tableGet(e)})),te.on("table-edit",(({historyObj:t,resultValue:o})=>{this.tableGet(t.loc);const s=e[t.prop];this[s]=t[o],this.tableSet(!1)}))},methods:{eventListen(e){const t=e.key;"Enter"==t&&this.tableSet(!0)},tableGet(e){e&&(this.targetNodeLoc=e,this.getNodeObj({location:e,callback:(e,t)=>{this.targetNode=e[t]}})),this.row=this.targetNode.CTS.length,this.col=this.targetNode.CTS[0].length},tableSet(e){const t=this.targetNode.CTS.length,o=this.targetNode.CTS[0].length,s=Math.abs(this.row-t),i=Math.abs(this.col-o);if(this.col!=o)if(e&&te.emit("add-history",{loc:this.targetNodeLoc,prop:"COL",before:o,after:this.col}),this.col>o)for(let n of this.targetNode.CTS)for(let e=0;e<i;e++)n.push("");else for(let n of this.targetNode.CTS)for(let e=0;e<i;e++)n.pop();if(this.row!=t)if(e&&te.emit("add-history",{loc:this.targetNodeLoc.loc,prop:"ROW",before:t,after:this.row}),this.row>t){let e=[];for(let t=0;t<this.col;t++)e.push("");for(let t=0;t<s;t++)this.targetNode.CTS.push([...e])}else for(let n=0;n<s;n++)this.targetNode.CTS.pop()}},watch:{disabled(e){e?(this.targetNode=null,this.targetNodeLoc=[],removeEventListener("keydown",this.eventListen)):addEventListener("keydown",this.eventListen)},row(e){e<1?this.timeout=setTimeout((()=>{this.row=1}),1e3):clearTimeout(this.timeout)},col(e){e<1?this.timeout=setTimeout((()=>{this.col=1}),1e3):clearTimeout(this.timeout)}}};const rs=(0,W.Z)(as,[["render",ds],["__scopeId","data-v-75915245"]]);var hs=rs;const us=e=>((0,i.dD)("data-v-5fab3036"),e=e(),(0,i.Cn)(),e),ps={class:"history fixed-component"},bs=us((()=>(0,i._)("i",{class:"material-icons"},"undo",-1))),ms=[bs],fs=us((()=>(0,i._)("i",{class:"material-icons"},"redo",-1))),vs=[fs],Ts=us((()=>(0,i._)("i",{class:"material-icons"},"menu",-1))),gs=[Ts];function Cs(e,t,o,l,c,d){const a=(0,i.up)("history-view"),r=(0,i.up)("drawer");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(s.uT,{name:"slide"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",ps,[(0,i._)("div",{class:(0,n.C_)(["btn btn-shallow",{disabled:c.historyIndex==d.note.HT.length-1}]),onClick:t[0]||(t[0]=e=>d.doit("undo"))},ms,2),(0,i._)("div",{class:(0,n.C_)(["btn btn-shallow",{disabled:c.historyIndex<0}]),onClick:t[1]||(t[1]=e=>d.doit("redo"))},vs,2),(0,i._)("div",{class:(0,n.C_)(["btn btn-shallow",{disabled:!d.note.HT.length}]),onClick:t[2]||(t[2]=e=>c.drawerDisabled=!1)},gs,2)],512),[[s.F8,!o.disabled]])])),_:1}),(0,i.Wm)(r,{title:"编辑历史",disabled:c.drawerDisabled,onCloseDrawer:t[3]||(t[3]=e=>c.drawerDisabled=!0)},{default:(0,i.w5)((()=>[(0,i.Wm)(a,{list:d.note.HT,index:c.historyIndex},null,8,["list","index"])])),_:1},8,["disabled"])],64)}o(541);const _s=e=>((0,i.dD)("data-v-45d2a3a0"),e=e(),(0,i.Cn)(),e),ws=_s((()=>(0,i._)("span",{class:"history-prop"},"位置：",-1))),ks={class:"loc"},Ns=_s((()=>(0,i._)("span",{class:"history-prop"},"属性：",-1))),ys={class:"prop"},xs=_s((()=>(0,i._)("span",{class:"history-prop"},"改前：",-1))),Ms=["title"],Ls=_s((()=>(0,i._)("span",{class:"history-prop"},"改后：",-1))),js=["title"],Ds=["data-index"];function Ss(e,t,o,l,c,d){return(0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.list,((e,o)=>((0,i.wg)(),(0,i.iD)("div",{class:"history-block",key:e.id,ref_for:!0,ref:"historyBlock"},[(0,i._)("div",null,[ws,(0,i._)("span",ks,(0,n.zw)(e.loc),1)]),(0,i._)("div",null,[Ns,(0,i._)("span",ys,(0,n.zw)(c.propsDict[e.prop]),1)]),(0,i.wy)((0,i._)("div",null,[xs,(0,i._)("span",{class:"text",title:e.before},(0,n.zw)(e.before),9,Ms)],512),[[s.F8,e.before]]),(0,i.wy)((0,i._)("div",null,[Ls,(0,i._)("span",{class:"text",title:e.after},(0,n.zw)(e.after),9,js)],512),[[s.F8,e.after]]),(0,i._)("div",{class:"btn btn-shallow",onClick:t[0]||(t[0]=(...e)=>d.doSome&&d.doSome(...e))},[(0,i._)("i",{class:"material-icons","data-index":o},"check",8,Ds)])])))),128)}var Os={props:["list","index"],data(){return{propsDict:{CT:"内容",CL:"颜色",SUM:"题目",ROW:"行数",COL:"列数",IST:"插入",DEL:"删除"}}},methods:{doSome(e){const t=e.target,o=t.dataset["index"],s=this.$parent.$parent;s.doSome(o)}},watch:{index(e,t){const o=this.$el.parentNode,s=o.children[e],i=o.children[t];e>-1&&s.classList.add("selected"),t>-1&&i.classList.remove("selected")}}};const $s=(0,W.Z)(Os,[["render",Ss],["__scopeId","data-v-45d2a3a0"]]);var Fs=$s,Is={data(){return{drawerDisabled:!0,historyIndex:-1}},components:{Drawer:Qt,HistoryView:Fs},props:["disabled"],inject:["note","selectedNode"],mixins:[Y,z,q],methods:{doit(e){const t="undo"==e?++this.historyIndex:this.historyIndex--;let o=this.note.HT[t];const s="undo"==e?"before":"after";switch(o.prop){case"CT":case"CL":case"SUM":this.getNodeObj({location:o.loc,callback:(e,t)=>{const i=e[t];i[o.prop]=o[s]}});break;case"ROW":case"COL":te.emit("table-edit",{historyObj:o,resultValue:s});break;case"IST":{const e=o.loc,t=this.deleteNode(e);o.prop="DEL",o.loc[o.loc.length-1]-=1,o.nodeObj=t;break}case"DEL":{const e=o.nodeObj,t=o.loc;this.insertNode(e,t),o.prop="IST",o.loc[o.loc.length-1]+=1;break}}},doSome(e){const t=e-this.historyIndex,o=Math.abs(t);let s;if(t>0)s="undo";else{if(!(t<0))return;s="redo"}for(let i=0;i<o;i++)this.doit(s)}},mounted(){addEventListener("keydown",(e=>{const t=e.altKey,o=e.key;t&&"z"==o&&this.doit("undo")})),addEventListener("keydown",(e=>{const t=e.altKey,o=e.key;t&&"y"==o&&this.doit("redo")})),te.on("add-history",(e=>{const t=this.note.HT;if(20==t.length&&t.pop(),this.historyIndex<0)t.unshift(e);else{const o=this.historyIndex+1;t.splice(0,o),t.unshift(e),this.historyIndex=-1}})),te.on("clear-history",(()=>{this.historyIndex=-1}))}};const Es=(0,W.Z)(Is,[["render",Cs],["__scopeId","data-v-5fab3036"]]);var As=Es,Hs={data(){return{textfieldGroupDisabled:!0,colorsDisabled:!0,tableSetterDisabled:!0,historyDisabled:!1}},components:{TextfieldGroupFixed:Zo,Colors:Po,TableSetter:hs,History:As},methods:{open(e){this.closeAll(),this[e+"Disabled"]=!1},close(e){this[e+"Disabled"]=!0,this.historyDisabled=!1},closeAll(){this.colorsDisabled=!0,this.textfieldGroupDisabled=!0,this.tableSetterDisabled=!0,this.historyDisabled=!0}},mounted(){te.on("fixedComponents-open",this.open),te.on("textfield-open",(()=>{this.open("textfieldGroup")})),te.on("fixedComponents-close",(()=>{this.closeAll(),this.historyDisabled=!1}))}};const Ws=(0,W.Z)(Hs,[["render",vo],["__scopeId","data-v-ab5781fc"]]);var Bs=Ws;const Zs={class:"msgbar-outer"};function Us(e,t,o,l,c,d){return(0,i.wg)(),(0,i.j4)(s.uT,{name:"slide"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",Zs,[(0,i._)("div",{class:(0,n.C_)(["msgbar",{active:c.active}]),onClick:t[0]||(t[0]=(...e)=>d.close&&d.close(...e))},(0,n.zw)(c.msg),3)],512),[[s.F8,c.active]])])),_:1})}var Ks={data(){return{active:!1,msg:""}},methods:{close(){this.active=!1}},mounted(){te.on("show-msg",(e=>{this.msg=e,this.active=!0}))},watch:{active(e){e&&setTimeout((()=>{this.close()}),3e3)}}};const Vs=(0,W.Z)(Ks,[["render",Us]]);var Rs=Vs,Gs={NM:"Example",HT:[],CTS:[{NT:"h",CT:"这是一个大标题",CL:"#333"},{NT:"hr"},{NT:"p",CT:"这是一个段落",CL:"#333"},{NT:"p",CT:"内联样式实例（均使用英文符号）：##粗体## ``代码`` __下划线__ //斜体// --删除-- ::淡化::",CL:"#333"},{NT:"link",CT:"一个链接",HF:"https://www.bing.com",CL:"#333"},{NT:"floor",CTS:[{NT:"h",CT:"这是层次中的大标题",CL:"#333"},{NT:"p",CT:"这是一个段落",CL:"#333"},{NT:"floor",CTS:[{NT:"h",CT:"这是层次中的大标题",CL:"#333"},{NT:"p",CT:"这是一个段落",CL:"#333"}]}]},{NT:"list",OL:!0,CTS:[{NT:"li",CT:"这是一个列表项",CL:"#333"},{NT:"li",CT:"这是一个列表项",CL:"#333"},{NT:"list",OL:!1,CTS:[{NT:"li",CT:"嵌套列表内的列表项",CL:"#333"},{NT:"li",CT:"嵌套列表内的列表项",CL:"#333"}]}]},{NT:"table",CTS:[["表格项","表格项","表格项","表格项"],["表格项","表格项","表格项","表格项"]]},{NT:"details",SUM:"这是一个详情块",CTS:[{CT:"这是一个段落",CL:"#333"},{CT:"这是一个段落",CL:"#333"}]},{NT:"code",LG:"javascript",CT:"console.log('Hello World')\nalert('Hello World')"}]},Ys={name:"App",components:{Anchors:to,Msgbar:Rs,Note:Vt,ToolBar:le,ControlBalls:fo,FixedComponents:Bs},data(){return{windowDisabled:!1,note:Gs,selectedNode:{loc:null,obj:null,vnode:null,type:null},isDarkMode:!1,isTouchMode:!1,isFullscreen:!1}},provide(){return{note:this.note,selectedNode:this.selectedNode,isTouchMode:(0,i.Fl)((()=>this.isTouchMode))}},mounted(){this.$nextTick((()=>{const e=()=>{const e=document.querySelector("#meta-viewport");let t;window&&(t=window.outerHeight);const o=`width=device-width,height=${t},initial-scale=1.0`;e.setAttribute("content",o)};e(),addEventListener("orientationchange",(()=>{e()}))}))}};const zs=(0,W.Z)(Ys,[["render",l]]);var qs=zs;o(9029);const Js=(0,s.ri)(qs);Js.use(ft.Z),Js.config.unwrapInjectedRef=!0,Js.mount("#app")}},t={};function o(s){var i=t[s];if(void 0!==i)return i.exports;var n=t[s]={exports:{}};return e[s].call(n.exports,n,n.exports,o),n.exports}o.m=e,function(){var e=[];o.O=function(t,s,i,n){if(!s){var l=1/0;for(r=0;r<e.length;r++){s=e[r][0],i=e[r][1],n=e[r][2];for(var c=!0,d=0;d<s.length;d++)(!1&n||l>=n)&&Object.keys(o.O).every((function(e){return o.O[e](s[d])}))?s.splice(d--,1):(c=!1,n<l&&(l=n));if(c){e.splice(r--,1);var a=i();void 0!==a&&(t=a)}}return t}n=n||0;for(var r=e.length;r>0&&e[r-1][2]>n;r--)e[r]=e[r-1];e[r]=[s,i,n]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var s in t)o.o(t,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,s){var i,n,l=s[0],c=s[1],d=s[2],a=0;if(l.some((function(t){return 0!==e[t]}))){for(i in c)o.o(c,i)&&(o.m[i]=c[i]);if(d)var r=d(o)}for(t&&t(s);a<l.length;a++)n=l[a],o.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return o.O(r)},s=self["webpackChunkBNotee"]=self["webpackChunkBNotee"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=o.O(void 0,[998],(function(){return o(3059)}));s=o.O(s)})();
//# sourceMappingURL=app.4f29a6ad.js.map