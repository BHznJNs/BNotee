(function(e){function t(t){for(var n,i,r=t[0],s=t[1],a=t[2],u=0,f=[];u<r.length;u++)i=r[u],Object.prototype.hasOwnProperty.call(c,i)&&c[i]&&f.push(c[i][0]),c[i]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);d&&d(t);while(f.length)f.shift()();return l.push.apply(l,a||[]),o()}function o(){for(var e,t=0;t<l.length;t++){for(var o=l[t],n=!0,r=1;r<o.length;r++){var s=o[r];0!==c[s]&&(n=!1)}n&&(l.splice(t--,1),e=i(i.s=o[0]))}return e}var n={},c={app:0},l=[];function i(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=n,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],s=r.push.bind(r);r.push=t,r=r.slice();for(var a=0;a<r.length;a++)t(r[a]);var d=s;l.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"366b":function(e,t,o){},"38b9":function(e,t,o){},"400c":function(e,t,o){},"4d38":function(e,t,o){"use strict";o("ac9a")},"4f12":function(e,t,o){"use strict";o("b46b")},5143:function(e,t,o){},"56d7":function(e,t,o){"use strict";o.r(t);o("e260"),o("e6cf"),o("cca6"),o("a79d");var n=o("7a23");function c(e,t,o,c,l,i){var r=Object(n["p"])("tool-bar"),s=Object(n["p"])("note"),a=Object(n["p"])("textfield-group-fixed"),d=Object(n["p"])("colors");return Object(n["l"])(),Object(n["d"])(n["a"],null,[Object(n["h"])(r),Object(n["h"])(s),Object(n["h"])(a),Object(n["h"])(d)],64)}o("caad");var l=function(e){return Object(n["n"])("data-v-98f7677c"),e=e(),Object(n["m"])(),e},i={id:"toolbar",class:"shadow-3"},r=l((function(){return Object(n["e"])("i",{class:"logo material-icons shadow-2"},"format_list_bulleted",-1)})),s={class:"tools"},a=l((function(){return Object(n["e"])("i",{class:"material-icons"},"add",-1)})),d=[a],u=l((function(){return Object(n["e"])("i",{class:"material-icons"},"remove",-1)})),f=[u],b=l((function(){return Object(n["e"])("i",{class:"material-icons"},"color_lens",-1)})),p=[b],h=l((function(){return Object(n["e"])("i",{class:"material-icons"},"vertical_align_bottom",-1)})),j=[h],O=l((function(){return Object(n["e"])("i",{class:"material-icons file"},[Object(n["g"])("input "),Object(n["e"])("input",{id:"file-uploader",type:"file",accept:"application/json"})],-1)})),v=[O];function m(e,t,o,c,l,a){return Object(n["l"])(),Object(n["d"])("div",i,[r,Object(n["e"])("div",s,[Object(n["e"])("div",{class:Object(n["j"])(["tool btn-shallow",{disabled:!a.selectedNode.location}]),onClick:t[0]||(t[0]=function(){return a.openTextfield&&a.openTextfield.apply(a,arguments)})},d,2),Object(n["e"])("div",{class:Object(n["j"])(["tool btn-shallow",{disabled:!a.selectedNode.location}]),onClick:t[1]||(t[1]=function(){return a.deleteNode&&a.deleteNode.apply(a,arguments)})},f,2),Object(n["e"])("div",{class:Object(n["j"])(["tool btn-shallow",{disabled:!["basic-node","list-item"].includes(a.selectedNode.type)}]),onClick:t[2]||(t[2]=function(){return a.colorsOpen&&a.colorsOpen.apply(a,arguments)})},p,2),Object(n["e"])("div",{class:"tool btn-shallow",onClick:t[3]||(t[3]=function(){return a.saveNote&&a.saveNote.apply(a,arguments)})},j),Object(n["e"])("div",{class:"tool btn-shallow",onClick:t[4]||(t[4]=function(){return a.readNote&&a.readNote.apply(a,arguments)})},v)])])}o("a434"),o("e9c4");var N=o("21a6"),T=o.n(N),g={mounted:function(){var e=this;this.location&&this.getNodeObj({location:this.location,callback:function(t,o){e.nodeObj=t[o]}})},methods:{getNodeObj:function(e){var t=e.parentObj,o=void 0===t?this.note:t,n=e.location,c=e.num,l=void 0===c?0:c,i=e.callback;l==n.length-1?i&&i(o.CTS,n[l]):this.getNodeObj({parentObj:o.CTS[n[l]],location:n,num:l+1,callback:i})}}};const x=g;var C=x,y=o("1344"),k=new y["a"],S={inject:["note","selectedNode"],mixins:[C],mounted:function(){var e=this,t=document.querySelector("#file-uploader");t.addEventListener("change",(function(){var o=new FileReader;o.readAsText(t.files[0],"uft8"),o.onload=function(t){var o=t.target.result;e.note.CTS=JSON.parse(o)}})),k.on("textfield-return-toolBar",(function(t){e.insertNode(t)}))},methods:{insertNode:function(e){if(e){var t=this.selectedNode.location;t&&this.getNodeObj({location:t,callback:function(o,n){"floor"==e.NT&&(e.level=t.length),o.splice(n+1,0,e)}})}},deleteNode:function(){var e=this.selectedNode.location;this.selectedNode.location=null,this.selectedNode.type=null,this.getNodeObj({location:e,callback:function(e,t){e.splice(t,1)}})},colorsOpen:function(){k.emit("colors-open"),k.emit("note-offset")},saveNote:function(){var e=new Blob([JSON.stringify(this.note.CTS)],{type:"text/plain;charset=utf-8"});T()(e,"myNote.json")},readNote:function(){var e=document.querySelector("#file-uploader");e.click()},openTextfield:function(){k.emit("textfield-open","toolBar"),k.emit("note-offset")}}},L=(o("4d38"),o("6b0d")),w=o.n(L);const A=w()(S,[["render",m],["__scopeId","data-v-98f7677c"]]);var _=A,M=function(e){return Object(n["n"])("data-v-0f33f18a"),e=e(),Object(n["m"])(),e},P=M((function(){return Object(n["e"])("i",{class:"material-icons"},"add",-1)})),I=[P];function E(e,t,o,c,l,i){var r=Object(n["p"])("floor"),s=Object(n["p"])("basic-node"),a=Object(n["p"])("textfield-group");return Object(n["l"])(),Object(n["d"])("div",{class:Object(n["j"])(["note-outer shadow-3",{offset:l.offset}])},[Object(n["e"])("div",{class:"note",onContextmenu:t[1]||(t[1]=Object(n["s"])((function(){}),["prevent"]))},[(Object(n["l"])(!0),Object(n["d"])(n["a"],null,Object(n["o"])(i.note.CTS,(function(e,t){return Object(n["l"])(),Object(n["d"])(n["a"],{key:e.id},["floor"==e.NT?(Object(n["l"])(),Object(n["c"])(r,{key:0,children:e.CTS,selected:e.SL,level:1,location:[t]},null,8,["children","selected","location"])):(Object(n["l"])(),Object(n["c"])(s,{key:1,tagName:"h"==e.NT?e.NT+1:e.NT,content:e.CT,color:e.CL,selected:e.SL,location:[t]},null,8,["tagName","content","color","selected","location"]))],64)})),128)),Object(n["h"])(a,{isAdding:l.isNodeAdding,onToParent:i.closeNodeAdder},null,8,["isAdding","onToParent"]),Object(n["e"])("div",{class:Object(n["j"])(["btn adder-btn",{disabled:l.isNodeAdding}]),onClick:t[0]||(t[0]=function(){return i.openNodeAdder&&i.openNodeAdder.apply(i,arguments)})},I,2)],32)],2)}o("2532");var F={data:function(){return{nodeObj:null,initialContent:this.content,editing:!1}},inject:["note","selectedNode"],props:["tagName","content","location","selected","color"],mixins:[C],computed:{fontColor:function(){return!this.color||this.color.includes("--")?"var(".concat(this.color,")"):this.color}},methods:{selectEvent:function(){this.selected?(k.emit("textfield-close"),k.emit("colors-close"),this.selectedNode.location=null,this.selectedNode.type=null,this.nodeObj.SL=!1):(this.selectedNode.location&&this.getNodeObj({location:this.selectedNode.location,callback:function(e,t){e[t].SL=!1}}),this.selectedNode.location=this.location,this.selectedNode.type="basic-node",this.nodeObj.SL=!0)}},render:function(){var e=this;return Object(n["i"])(this.tagName,{contentEditable:!0,class:{selected:this.selected,editing:this.editing},style:{color:this.fontColor},onContextmenu:function(t){t.preventDefault(),e.selectEvent()},onClick:function(t){e.initialContent=t.target.innerText,e.editing=!0},onBlur:function(t){var o=t.target.innerText;o!=e.initialContent&&(e.nodeObj.CT=o),e.editing=!1}},this.content)}};const B=F;var V=B,q=(o("99af"),function(e){return Object(n["n"])("data-v-bf829ff0"),e=e(),Object(n["m"])(),e}),J=q((function(){return Object(n["e"])("div",{class:"mask"},null,-1)})),D=q((function(){return Object(n["e"])("i",{class:"material-icons"},"add",-1)})),G=[D],$={class:"checkbox"},K=["checked"],R=q((function(){return Object(n["e"])("i",{class:"checkbox-icon"},null,-1)}));function U(e,t,o,c,l,i){var r=Object(n["p"])("floor",!0),s=Object(n["p"])("basic-node");return Object(n["l"])(),Object(n["d"])("div",{class:Object(n["j"])(["floor shadow-2",{"shadow-6":o.selected}]),onMouseenter:t[2]||(t[2]=function(){return i.onMouseEnter&&i.onMouseEnter.apply(i,arguments)}),onMouseleave:t[3]||(t[3]=function(){return i.onMouseLeave&&i.onMouseLeave.apply(i,arguments)})},[J,(Object(n["l"])(!0),Object(n["d"])(n["a"],null,Object(n["o"])(o.children,(function(e,t){return Object(n["l"])(),Object(n["d"])(n["a"],{key:e.id},["floor"==e.NT?(Object(n["l"])(),Object(n["c"])(r,{key:0,children:e.CTS,selected:e.SL,level:o.level+1,location:o.location.concat([t]),onMouseOut:i.onMouseLeave},null,8,["children","selected","level","location","onMouseOut"])):(Object(n["l"])(),Object(n["c"])(s,{key:1,tagName:"h"==e.NT?e.NT+(o.level+1):e.NT,content:e.CT,color:e.CL,selected:e.SL,location:o.location.concat([t])},null,8,["tagName","content","color","selected","location"]))],64)})),128)),Object(n["e"])("div",{class:Object(n["j"])(["controls",{disabled:!l.hover}])},[Object(n["e"])("div",{class:"btn adder-btn",onClick:t[0]||(t[0]=function(){return i.openTextfield&&i.openTextfield.apply(i,arguments)})},G),Object(n["e"])("label",$,[Object(n["e"])("input",{type:"checkbox",checked:o.selected,onChange:t[1]||(t[1]=function(e){return i.select(e)})},null,40,K),R])],2)],34)}var z={name:"floor",components:{basicNode:V},data:function(){return{nodeObj:null,hover:!1,setTimeout:null}},props:["children","level","location","selected"],inject:["note","selectedNode"],mixins:[C],methods:{select:function(e){var t=e.target.checked;this.nodeObj.SL=t,t?(this.selectedNode.location&&this.getNodeObj({location:this.selectedNode.location,callback:function(e,t){e[t].SL=!1}}),this.selectedNode.location=this.location,this.selectedNode.type="floor"):(this.selectedNode.location=null,this.selectedNode.type=null)},openTextfield:function(){var e=this;k.emit("textfield-open","floor"),k.on("textfield-return-floor",(function(t){t||e.nodeObj.CTS.push(t),k.off("textfield-return-floor")}))},onMouseEnter:function(){var e=this;this.setTimeout=setTimeout((function(){e.hover=!0}),400),this.location.length>1&&this.$emit("mouse-out")},onMouseLeave:function(){clearTimeout(this.setTimeout),this.selected||(this.hover=!1)}}};o("f507");const H=w()(z,[["render",U],["__scopeId","data-v-bf829ff0"]]);var Q=H,W=Object(n["f"])('<select class="selector"><option value="h">标题</option><option value="p">段落</option><option value="floor">层次</option></select><div class="textfield" contenteditable="true"></div>',2),X=Object(n["e"])("i",{class:"material-icons"},"close",-1),Y=[X];function Z(e,t,o,c,l,i){return Object(n["l"])(),Object(n["d"])("div",{class:Object(n["j"])(["textfield-group",{disabled:!o.isAdding}])},[W,Object(n["e"])("div",{class:"textfield-closer closer",onClick:t[0]||(t[0]=function(e){return i.closeNodeAdder(e)})},Y)],2)}var ee={props:["isAdding"],methods:{closeNodeAdder:function(e){var t=e.target,o=t.parentNode.children[0],n=t.parentNode.children[1],c=o.value,l=n.innerText,i={NT:c,SL:!1};["floor"].includes(c)?i.CTS=[]:l?(i.CL=null,i.CT=l):i=null,this.$emit("toParent",i),n.blur(),n.innerText=""}}};const te=w()(ee,[["render",Z]]);var oe=te,ne={components:{basicNode:V,Floor:Q,TextfieldGroup:oe},data:function(){return{isNodeAdding:!1,offset:!1}},inject:["note"],created:function(){var e=this;addEventListener("keydown",(function(t){var o=t.altKey,n=t.key;o&&"a"==n&&(t.preventDefault(),e.openNodeAdder())}))},mounted:function(){var e=this;k.on("note-offset",(function(){e.offset=!0})),k.on("colors-close",(function(){e.offset=!1})),k.on("textfield-return",(function(){e.offset=!1}))},methods:{openNodeAdder:function(){var e=document.querySelector(".note > .textfield-group > .textfield");this.isNodeAdding=!0,e.focus()},closeNodeAdder:function(e){this.isNodeAdding=!1,e&&this.note.CTS.push(e)}}};o("dcc1");const ce=w()(ne,[["render",E],["__scopeId","data-v-0f33f18a"]]);var le=ce,ie=Object(n["f"])('<select class="selector"><option value="h">标题</option><option value="p">段落</option><option value="floor">层次</option></select><div class="textfield" contenteditable="true"></div>',2),re=Object(n["e"])("i",{class:"material-icons"},"close",-1),se=[re];function ae(e,t,o,c,l,i){return Object(n["l"])(),Object(n["d"])("div",{class:Object(n["j"])(["textfield-group fixed shadow-3",{disabled:!l.isInputting}])},[ie,Object(n["e"])("div",{class:"textfield-closer closer",onClick:t[0]||(t[0]=function(e){return i.closeTextfield(e)})},se)],2)}var de={data:function(){return{isInputting:!1,commandFrom:""}},mounted:function(){var e=this;k.on("textfield-open",(function(t){e.commandFrom=t,e.isInputting=!0})),k.on("textfield-close",this.close),k.on("colors-open",this.close)},methods:{close:function(){this.isInputting=!1,k.emit("textfield-return")},closeTextfield:function(e){this.isInputting=!1;var t=e.target,o=t.parentNode.children[0],n=t.parentNode.children[1],c=o.value,l=n.innerText,i={NT:c,SL:!1};["floor"].includes(c)?i.CTS=[]:l?(i.CL=null,i.CT=n.innerText):i=null,k.emit("textfield-return-"+this.commandFrom,i),k.emit("textfield-return"),n.blur(),n.innerText=""}}};const ue=w()(de,[["render",ae]]);var fe=ue,be=function(e){return Object(n["n"])("data-v-2abb14f2"),e=e(),Object(n["m"])(),e},pe=["onClick"],he={class:"color-inputer"},je=be((function(){return Object(n["e"])("div",{class:"hint"},"#",-1)})),Oe=be((function(){return Object(n["e"])("i",{class:"material-icons"},"close",-1)})),ve=[Oe];function me(e,t,o,c,l,i){return Object(n["l"])(),Object(n["d"])("div",{class:Object(n["j"])(["colors shadow-3",{disabled:l.disabled}])},[(Object(n["l"])(!0),Object(n["d"])(n["a"],null,Object(n["o"])(l.colors,(function(e){return Object(n["l"])(),Object(n["d"])("div",{key:e.id,class:"color btn-shallow",style:Object(n["k"])({"background-color":"var(".concat(e,")")}),onClick:function(t){return i.setColor(e)}},null,12,pe)})),128)),Object(n["e"])("div",he,[je,Object(n["r"])(Object(n["e"])("input",{class:"inputer",placeholder:"******",type:"text","onUpdate:modelValue":t[0]||(t[0]=function(e){return l.colorValue=e})},null,512),[[n["q"],l.colorValue]])]),Object(n["e"])("div",{class:"closer",onClick:t[1]||(t[1]=function(){return i.close&&i.close.apply(i,arguments)})},ve)],2)}var Ne={data:function(){return{disabled:!0,colors:["--highlight-color","--warning-color","--default-text-color","white"],colorValue:"",timeout:null,targetNode:null}},inject:["selectedNode","note"],mixins:[C],mounted:function(){var e=this;k.on("colors-open",(function(){e.disabled=!1,e.getNodeObj({location:e.selectedNode.location,callback:function(t,o){e.targetNode=t[o]}})})),k.on("colors-close",(function(){e.disabled=!0,e.targetNode=null})),k.on("textfield-open",(function(){e.disabled=!0}))},methods:{setColor:function(e){this.targetNode.CL=e},close:function(){k.emit("colors-close")}},watch:{colorValue:function(e){var t=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){t.setColor("#"+e)}),600)}}};o("ac03");const Te=w()(Ne,[["render",me],["__scopeId","data-v-2abb14f2"]]);var ge=Te,xe={CTS:[{NT:"h",CT:"这是一个大标题",CL:null,SL:!1},{NT:"p",CT:"这是一个段落",CL:null,SL:!1},{NT:"floor",SL:!1,CTS:[{NT:"h",CT:"这是层次中的大标题",CL:null,SL:!1},{NT:"p",CT:"这是一个段落",CL:null,SL:!1},{NT:"floor",SL:!1,CTS:[{NT:"h",CT:"这是层次中的大标题",CL:null,SL:!1},{NT:"p",CT:"这是一个段落",CL:null,SL:!1}]}]}]},Ce={name:"App",components:{Note:le,ToolBar:_,Colors:ge,TextfieldGroupFixed:fe},data:function(){return{note:xe,selectedNode:{location:null,type:null}}},provide:function(){return{note:this.note,selectedNode:this.selectedNode}}};o("4f12");const ye=w()(Ce,[["render",c]]);var ke=ye,Se=(o("5143"),o("f16b"),o("38b9"),o("86be"),o("61fd"),o("8d2a"),o("cde1"),Object(n["b"])(ke));Se.mount("#app")},"61fd":function(e,t,o){},"69fc":function(e,t,o){},"86be":function(e,t,o){},"8d2a":function(e,t,o){},ac03:function(e,t,o){"use strict";o("69fc")},ac9a:function(e,t,o){},b46b:function(e,t,o){},cde1:function(e,t,o){},dcc1:function(e,t,o){"use strict";o("400c")},f16b:function(e,t,o){},f507:function(e,t,o){"use strict";o("366b")}});
//# sourceMappingURL=app.445011e7.js.map