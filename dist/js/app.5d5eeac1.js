(function(e){function t(t){for(var o,l,r=t[0],d=t[1],a=t[2],u=0,f=[];u<r.length;u++)l=r[u],Object.prototype.hasOwnProperty.call(c,l)&&c[l]&&f.push(c[l][0]),c[l]=0;for(o in d)Object.prototype.hasOwnProperty.call(d,o)&&(e[o]=d[o]);s&&s(t);while(f.length)f.shift()();return i.push.apply(i,a||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],o=!0,r=1;r<n.length;r++){var d=n[r];0!==c[d]&&(o=!1)}o&&(i.splice(t--,1),e=l(l.s=n[0]))}return e}var o={},c={app:0},i=[];function l(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=e,l.c=o,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)l.d(n,o,function(t){return e[t]}.bind(null,o));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],d=r.push.bind(r);r.push=t,r=r.slice();for(var a=0;a<r.length;a++)t(r[a]);var s=d;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},1378:function(e,t,n){},"176a":function(e,t,n){},2073:function(e,t,n){"use strict";n("176a")},"280b":function(e,t,n){},"2d96":function(e,t,n){},4836:function(e,t,n){"use strict";n("b999")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("7a23");function c(e,t,n,c,i,l){var r=Object(o["n"])("tool-bar"),d=Object(o["n"])("note");return Object(o["j"])(),Object(o["d"])(o["a"],null,[Object(o["g"])(r),Object(o["g"])(d)],64)}var i=n("6e4d"),l=n.n(i),r=function(e){return Object(o["l"])("data-v-0fc20ac9"),e=e(),Object(o["k"])(),e},d={id:"toolbar",class:"mdui-shadow-3"},a=r((function(){return Object(o["e"])("img",{id:"logo",class:"mdui-shadow-2",src:l.a,draggable:"false"},null,-1)})),s={class:"tools"},u=r((function(){return Object(o["e"])("i",{class:"material-icons"},"add",-1)})),f=[u],b=r((function(){return Object(o["e"])("i",{class:"material-icons"},"remove",-1)})),p=[b];function j(e,t,n,c,i,l){var r=Object(o["n"])("textfield-group");return Object(o["j"])(),Object(o["d"])("div",d,[a,Object(o["e"])("div",s,[Object(o["e"])("div",{class:Object(o["i"])(["tool mdui-shadow-1",{disabled:!l.selectedEl.length}]),onClick:t[0]||(t[0]=function(){return l.openInserter&&l.openInserter.apply(l,arguments)})},f,2),Object(o["e"])("div",{class:Object(o["i"])(["tool mdui-shadow-1",{disabled:!l.selectedEl.length}]),onClick:t[1]||(t[1]=function(){return l.deleteNode&&l.deleteNode.apply(l,arguments)})},p,2)]),Object(o["g"])(r,{type:"fixed",id:"main-textfield-group",isAdding:l.isNodeInserting[0],onToParent:l.closeNodeInserter},null,8,["isAdding","onToParent"])])}n("a434");var v=function(e){return Object(o["l"])("data-v-3cb56018"),e=e(),Object(o["k"])(),e},O=Object(o["f"])('<select class="selector" data-v-3cb56018><option value="h" data-v-3cb56018>标题</option><option value="p" data-v-3cb56018>段落</option><option value="floor" data-v-3cb56018>层次</option></select><div class="textfield" contenteditable="true" data-v-3cb56018></div>',2),g=v((function(){return Object(o["e"])("i",{class:"material-icons"},"close",-1)})),h=[g];function m(e,t,n,c,i,l){return Object(o["j"])(),Object(o["d"])("div",{class:Object(o["i"])(["textfield-group",{disabled:!n.isAdding,fixed:"fixed"==n.type,"mdui-shadow-3":"fixed"==n.type}]),tabindex:"999"},[O,Object(o["e"])("button",{class:"textfield-closer",onClick:t[0]||(t[0]=function(e){return l.closeNodeAdder(e)})},h)],2)}var N={methods:{closeNodeAdder:function(e){var t=e.target,n=t.parentNode.children[0],o=t.parentNode.children[1],c=n.value,i=o.innerText;"floor"==c&&(i={level:null,contents:[]}),this.$emit("toParent",[c,i]),o.blur(),o.innerText=""}},props:["isAdding","type"]},y=(n("ea48"),n("6b0d")),k=n.n(y);const x=k()(N,[["render",m],["__scopeId","data-v-3cb56018"]]);var E=x,A={components:{textfieldGroup:E},inject:["note","selectedEl","isNodeInserting"],methods:{getNodeEl:function(e){var t=e.nodeEl,n=void 0===t?this.note:t,o=e.location,c=e.num,i=void 0===c?0:c,l=e.callback;if(i==o.length-1)l&&l(n.contents,o[i]);else{var r=i+1;this.getNodeEl({nodeEl:n.contents[o[i]][1],location:o,num:r,callback:l})}},closeNodeInserter:function(e){if(this.isNodeInserting[0]=!1,e[1]){var t=this.selectedEl[0];this.getNodeEl({location:t,callback:function(n,o){"floor"==e[0]&&(e[1].level=t.length),n.splice(o+1,0,e)}})}},openInserter:function(){this.isNodeInserting[0]=!0},deleteNode:function(){var e=this.selectedEl.pop();this.getNodeEl({location:e,callback:function(e,t){e.splice(t,1)}}),console.log(this.note)}}};n("2073");const w=k()(A,[["render",j],["__scopeId","data-v-0fc20ac9"]]);var I=w,_=function(e){return Object(o["l"])("data-v-fd9afcb6"),e=e(),Object(o["k"])(),e},P=_((function(){return Object(o["e"])("i",{class:"material-icons"},"add",-1)})),T=[P];function C(e,t,n,c,i,l){var r=Object(o["n"])("note-node"),d=Object(o["n"])("floor"),a=Object(o["n"])("textfield-group");return Object(o["j"])(),Object(o["d"])("div",{class:Object(o["i"])(["note-outer mdui-shadow-3",{inserting:l.isNodeInserting[0]}])},[Object(o["e"])("div",{class:"note",onContextmenu:t[1]||(t[1]=Object(o["o"])((function(){}),["prevent"]))},[(Object(o["j"])(!0),Object(o["d"])(o["a"],null,Object(o["m"])(l.note.contents,(function(e,t){return Object(o["j"])(),Object(o["d"])(o["a"],{key:e.id},["h"==e[0]?(Object(o["j"])(),Object(o["c"])(r,{key:0,tagName:e[0]+(l.note.level+1),content:e[1],location:[t]},null,8,["tagName","content","location"])):"floor"==e[0]?(Object(o["j"])(),Object(o["c"])(d,{key:1,children:e[1],location:[t]},null,8,["children","location"])):(Object(o["j"])(),Object(o["c"])(r,{key:2,tagName:e[0],content:e[1],location:[t]},null,8,["tagName","content","location"]))],64)})),128)),Object(o["g"])(a,{type:"dafault",isAdding:i.isNodeAdding,onToParent:l.closeNodeAdder},null,8,["isAdding","onToParent"]),Object(o["e"])("button",{class:Object(o["i"])(["adder-btn mdui-color-blue-grey-100 mdui-btn mdui-btn-raised",{disabled:i.isNodeAdding}]),onClick:t[0]||(t[0]=function(){return l.openNodeAdder&&l.openNodeAdder.apply(l,arguments)})},T,2)],32)],2)}n("caad"),n("2532"),n("ac1f"),n("1276");var S={data:function(){return{initialContent:this.content,editing:!1}},inject:["note","selectedEl"],props:["tagName","content","location"],computed:{selected:function(){return this.content.includes("*")}},methods:{getNodeEl:function(e){var t=e.nodeEl,n=void 0===t?this.note:t,o=e.location,c=void 0===o?this.location:o,i=e.num,l=void 0===i?0:i,r=e.callback;if(l==c.length-1)r&&r(n.contents[c[l]]);else{var d=l+1;this.getNodeEl({nodeEl:n.contents[c[l]][1],location:c,num:d,callback:r})}}},render:function(){var e=this;return Object(o["h"])(this.tagName,{contentEditable:!0,class:{selected:this.selected,editing:this.editing},onContextmenu:function(t){t.preventDefault(),e.getNodeEl({callback:function(t){e.selected?(e.selectedEl.pop(),t[1]=t[1].split("*")[0]):(e.selectedEl.length&&e.getNodeEl({location:e.selectedEl.pop(),callback:function(e){e[1]=e[1].split("*")[0]}}),e.selectedEl.push(e.location),t[1]+="*")}})},onClick:function(t){e.initialContent=t.target.innerText,e.editing=!0},onBlur:function(t){var n=t.target.innerText;n!=e.initialContent&&e.getNodeEl({callback:function(e){e[1]=n}}),e.editing=!1}},this.content.split("*")[0])}};const M=S;var B=M,D=(n("99af"),function(e){return Object(o["l"])("data-v-89c44568"),e=e(),Object(o["k"])(),e}),G={class:"floor mdui-shadow-2"},J=D((function(){return Object(o["e"])("div",{class:"mask"},null,-1)}));function q(e,t,n,c,i,l){var r=Object(o["n"])("note-node"),d=Object(o["n"])("floor",!0);return Object(o["j"])(),Object(o["d"])("div",G,[J,(Object(o["j"])(!0),Object(o["d"])(o["a"],null,Object(o["m"])(n.children.contents,(function(e,t){return Object(o["j"])(),Object(o["d"])(o["a"],{key:e.id},["h"==e[0]?(Object(o["j"])(),Object(o["c"])(r,{key:0,tagName:e[0]+(n.children.level+1),content:e[1],location:n.location.concat([t])},null,8,["tagName","content","location"])):"floor"==e[0]?(Object(o["j"])(),Object(o["c"])(d,{key:1,children:e[1],location:n.location.concat([t])},null,8,["children","location"])):(Object(o["j"])(),Object(o["c"])(r,{key:2,tagName:e[0],content:e[1],location:n.location.concat([t])},null,8,["tagName","content","location"]))],64)})),128))])}var K={name:"floor",components:{NoteNode:B},props:["children","location"],inject:["note"]};n("74fb");const L=k()(K,[["render",q],["__scopeId","data-v-89c44568"]]);var $=L,z={components:{NoteNode:B,floor:$,textfieldGroup:E},data:function(){return{isNodeAdding:!1}},inject:["note","isNodeInserting"],created:function(){var e=this;addEventListener("keydown",(function(t){var n=t.altKey,o=t.key;n&&"a"==o&&(t.preventDefault(),e.openNodeAdder())}))},methods:{openNodeAdder:function(){var e=document.querySelector(".note > .textfield-group > .textfield");this.isNodeAdding=!0,e.focus()},closeNodeAdder:function(e){e[1]&&("floor"==e[0]&&(e[1].level=1),this.note.contents.push(e)),this.isNodeAdding=!1,console.log(this.note)}}};n("bb58");const F=k()(z,[["render",C],["__scopeId","data-v-fd9afcb6"]]);var H=F,Q={name:"App",components:{Note:H,ToolBar:I},data:function(){return{note:{level:0,contents:[["h","这是一个大标题"],["p","这是一个段落"],["floor",{level:1,contents:[["h","这是层次中的大标题"],["p","这是一个段落"],["floor",{level:2,contents:[["h","这是层次中的大标题"],["p","这是一个段落"]]}]]}]]},selectedEl:[],isNodeInserting:[!1]}},provide:function(){return{note:this.note,selectedEl:this.selectedEl,isNodeInserting:this.isNodeInserting}}};n("4836");const R=k()(Q,[["render",c]]);var U=R;n("1378"),n("2d96"),n("ec1b"),n("7471");Object(o["b"])(U).mount("#app")},"6e4d":function(e,t,n){e.exports=n.p+"img/note.d54d2722.svg"},7471:function(e,t,n){},"74fb":function(e,t,n){"use strict";n("280b")},b999:function(e,t,n){},bb58:function(e,t,n){"use strict";n("f26c")},df8e:function(e,t,n){},ea48:function(e,t,n){"use strict";n("df8e")},ec1b:function(e,t,n){},f26c:function(e,t,n){}});
//# sourceMappingURL=app.5d5eeac1.js.map